<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title></title>
	<!--DO NOT FORGET THIS SCRIPT TAG SO YOU CAN USE JQUERY!!!!!-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
	<script type="text/javascript">

		//we're using a stacked card approach for our main viewing area
		//this array holds the ids of our cards and
		//the method allows us to easly switch the interface from one to the other
		var contentPanels = ['logonPanel', 'mainPanel'];

		//this function toggles which panel is showing, and also clears data from all panels
		function showPanel(panelId) {
			clearData();
			for (var i = 0; i < contentPanels.length; i++) {
				if (panelId == contentPanels[i]) {
					$("#" + contentPanels[i]).css("visibility", "visible");
				}
				else {
					$("#" + contentPanels[i]).css("visibility", "hidden");
				}
			}
		}

		//this function clears data from all panels
		function clearData() {
			clearLogon();
		}

		function LogOn(userId, pass) {
			//the url of the webservice we will be talking to
			//CASE SENSITIVE!!
			var webMethod = "ProjectServices.asmx/LogOn";
			//the parameters we will pass the service (in json format because curly braces)
			//note we encode the values for transmission over the web.  All the \'s are just
			//because we want to wrap our keynames and values in double quotes so we have to
			//escape the double quotes (because the overall string we're creating is in double quotes!)
			var parameters = "{\"uid\":\"" + encodeURI(userId) + "\",\"pass\":\"" + encodeURI(pass) + "\"}";

			//jQuery ajax method
			$.ajax({
				//post is more secure than get, and allows
				//us to send big data if we want.  really just
				//depends on the way the service you're talking to is set up, though
				type: "POST",
				//the url is set to the string we created above
				url: webMethod,
				//same with the data
				data: parameters,
				//these next two key/value pairs say we intend to talk in JSON format
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				//jQuery sends the data and asynchronously waits for a response.  when it
				//gets a response, it calls the function mapped to the success key here
				success: function (msg) {
					//the server response is in the msg object passed in to the function here
					//since our logon web method simply returns a true/false, that value is mapped
					//to a generic property of the server response called d (I assume short for data
					//but honestly I don't know...)
					if (msg.d) {
						//server replied true, so show the landing page: mainPanel
						showPanel('mainPanel');
						ShowMenu();
					}
					else {
						//server replied false, so let the user know
						//the logon failed
						alert("logon failed");
					}
				},
				error: function (e) {
					//if something goes wrong in the mechanics of delivering the
					//message to the server or the server processing that message,
					//then this function mapped to the error key is executed rather
					//than the one mapped to the success key.
					alert("Error in delivering the message to the server or the server processing that message");
				}
			});
		}

		//just shows the menu
		function ShowMenu() {
			$("#menu").css("visibility", "visible");
		}

		//just hides the menu
		function HideMenu() {
			$("#menu").css("visibility", "hidden");
		}

		//resets the logon inputs
		function clearLogon() {
			$('#logonId').val("");
			$('#logonPassword').val("");
		}

		//logs the user off both at the client and at the server
		function LogOff() {

			var webMethod = "ProjectServices.asmx/LogOff";
			$.ajax({
				type: "POST",
				url: webMethod,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {
					if (msg.d) {
						//we logged off, so go back to logon page,
						showPanel('logonPanel');
						HideMenu();
					}
					else {
					}
				},
				error: function (e) {
					alert("Error in delivering the message to the server or the server processing that message");
				}
			});
		}

		//this function executes once jQuery has successfully loaded and is
		//ready for business.  Usually, if we're wiring up event handlers via jQuery
		//then this is where they go.
		jQuery(function () {
			//when the app loads, show the logon panel to start with!
			showPanel('logonPanel');
		});

	</script>
	<!--END OF YOUR OWN JAVASCRIPT-->
	<!--AND YOUR OWN CSS CAN GO HERE AS WELL-->
	<style>
		/* hidden by default */
		.menu {
			visibility: hidden;
		}

		/* hidden by default */
		.contentPanel {
			visibility: hidden;
		}
	</style>
	<!--END OF YOUR OWN CSS-->
</head>
<body>

	<!-- Build Menu Here -->
	<div class="titleContainer">
		<span>Feedback!</span>
		<div id="menu" class="menu">
			<a href="#" onclick="LogOff()">Log Off</a>
			<hr />
		</div>
	</div>

	<!--
		we're using a stacked card approach for our main viewing area
		add cards within contentContainer array (above in JavaScript section) as individual divs
		!! DON'T FORGET TO ADD DIV ID TO JAVASCRIPT ARRAY: contentPanels !!
		that method allows us to easly switch the interface from one to the other
	 -->
	<div class="contentContainer">

		<div id="logonPanel" class="contentPanel logonPanel">
			<div class="logonBox">
				<form onsubmit="LogOn($('#logonId').val(), $('#logonPassword').val()); return false;">
					<div class="left">Log On</div>
					<hr />
					<div>
						ID: <input type="text" id="logonId" />
					</div>
					<div>
						Pwd: <input type="password" id="logonPassword" />
					</div>
					<hr />
					<div>
						<button type="submit">Go!</button>
					</div>
				</form>
			</div>
		</div>

		<div id="mainPanel" class="contentPanel mainPanel">
			<div class="left">Add contents here!!</div>
		</div>


	</div>

</body>
</html>
