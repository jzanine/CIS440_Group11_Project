﻿
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">

    <!--DO NOT FORGET THIS SCRIPT TAG SO YOU CAN USE JQUERY!!!!!-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
    <script type="text/javascript">

        //we're using a stacked card approach for our main viewing area
        //this array holds the ids of our cards and
        //the method allows us to easly switch the interface from one to the other
        var contentPanels = ['logonPanel', 'mainPanel', 'responsePanel', 'commentPanel', 'archivedPanel', 'accountPanel'];

        //this function toggles which panel is showing
        function showPanel(panelId) {
            for (var i = 0; i < contentPanels.length; i++) {
                if (panelId == contentPanels[i]) {
                    $("#" + contentPanels[i]).css("visibility", "visible");
                }
                else {
                    $("#" + contentPanels[i]).css("visibility", "hidden");
                }
            }
            // Hide the improvement banner on the login page
            if (panelId === 'logonPanel') {
                $("#improvementBanner").hide();
            }
        }

        function isAdmin() {
            var webMethod = "ProjectServices.asmx/IsAdmin";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        $("#menu").css("visibility", "visible");
                        $(".adminOnly").css("visibility", "visible");
                    }
                    else {
                        $("#menu").css("visibility", "visible");
                        $(".adminOnly").css("visibility", "hidden");
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        function LogOn(userId, pass) {
            //the url of the webservice we will be talking to
            //CASE SENSITIVE!!
            var webMethod = "ProjectServices.asmx/LogOn";
            var parameters = "{\"uid\":\"" + encodeURI(userId) + "\",\"pass\":\"" + encodeURI(pass) + "\"}";

            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        //server replied true, so show the landing page: mainPanel
                        showPanel('mainPanel');
                        ShowMenu();
                        skipsRemaining = 3; // Reset skips to 3
                        $(".randomCommentButton").css("visibility", "visible");

                        // If the user is not an admin, call fetchImprovementBanner() to show the banner.
                        $.ajax({
                            type: "POST",
                            url: "ProjectServices.asmx/IsAdmin",
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (adminResponse) {
                                if (!adminResponse.d) {
                                    // User is NOT admin → fetch and show banner if applicable
                                    fetchImprovementBanner();
                                } else {
                                    // Admin → hide banner
                                    $("#improvementBanner").hide();
                                }
                            }
                        });
                    }
                    else {
                        //server replied false, so let the user know
                        //the logon failed
                        alert("logon failed");
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        // Function to submit a suggestion
        function submitSuggestion() {
            var suggestion = $("#suggestionText").val();
            if (suggestion.trim() === "") {
                alert("Please enter a suggestion.");
                return;
            }
            var webMethod = "ProjectServices.asmx/SubmitSuggestion";
            var parameters = JSON.stringify({ suggestion: suggestion });

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var response = JSON.parse(msg.d);
                    if (response.success) {
                        alert("Suggestion submitted successfully!");
                        $("#suggestionText").val(""); // Clear input after success
                    } else {
                        alert("Submission failed: " + response.message);
                    }
                },
                error: function () {
                    alert("Error connecting to the server.");
                }
            });
        }

        // Function to submit a reply to a randomized comment
        function submitReply() {
            var replyContent = $("#replyText").val();
            var parentComment = $("#randomCommentDisplay").text(); // Capture the parent comment content

            if (replyContent.trim() === "") {
                alert("Please enter a reply.");
                return;
            }

            var importanceValue = $("input[name='important']:checked").val(); // Get the selected radio button value

            if (!importanceValue) {
                alert("Please select an importance value.");
                return;
            }


            var webMethod = "ProjectServices.asmx/SubmitReply";
            var parameters = JSON.stringify({ commentContent: parentComment, replyContent: replyContent });

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var response = JSON.parse(msg.d);
                    if (response.success) {
                        alert("Reply submitted successfully!");
                        $("#replyText").val(""); // Clear reply input box
                        loadRandomComment(); // Load a new random comment
                    } else {
                        alert("Submission failed: " + response.message);
                    }
                },
                error: function () {
                    alert("Error connecting to the server.");
                }
            });
        }

        // Function to submit the importance value for a comment
        function submitImportance() {
            var importanceValue = $("input[name='important']:checked").val(); // Get the selected radio button value
            var parentComment = $("#randomCommentDisplay").text().trim(); // Capture the parent comment content

            console.log("Selected importance value:", importanceValue); // Debugging log
            console.log("Captured comment content:", parentComment); // Debugging log

            if (!importanceValue) {
                alert("Please select an importance value.");
                return;
            }

            var webMethod = "ProjectServices.asmx/SubmitImportance";
            var parameters = JSON.stringify({ commentContent: parentComment, important: parseInt(importanceValue) });

            console.log("Submitting importance:", parameters); // Log the parameters for debugging
            console.log("Captured importance value before AJAX:", importanceValue);


            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var response = JSON.parse(msg.d);
                    console.log("Server response:", response); // Debugging log

                    if (response.success) {
                        $("input[name='important']").prop('checked', false); // Clear radio button selection
                    } else {
                        alert("Submission failed: " + response.message);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("AJAX Error:", status, error); // Log AJAX errors
                    alert("Error connecting to the server.");
                }
            });
        }


        //just shows the menu
        function ShowMenu() {
            isAdmin();
        }

        //just hides the menu
        function HideMenu() {
            $(".menu").css("visibility", "hidden");
            $(".adminOnly").css("visibility", "hidden");
        }

        //resets the logon inputs
        function clearLogon() {
            $('#logonId').val("");
            $('#logonPassword').val("");
        }

        //resets comments panel
        function clearCommentsPage() {
            document.getElementById("commentPanel").innerHTML = "";
        }

        // resets archived comments panel
        function clearArchivedPage() {
            document.getElementById("archivedPanel").innerHTML = "";
        }

        function clearAccountsPage() {
            document.getElementById("accountPanel").innerHTML = "";
        }

        function clearResponsePanel() {
            document.getElementById("randomCommentDisplay").innerHTML = "";
            skipTrackerArray = [];
            activeCommentCount = 0;
        }

        //this function clears data from all panels
        function clearData() {
            clearLogon();
            clearCommentsPage();
            clearArchivedPage();
            clearResponsePanel();
            clearAccountsPage();
            $(".randomCommentButton").css("visibility", "hidden");
        }

        //logs the user off both at the client and at the server
        function LogOff() {

            var webMethod = "ProjectServices.asmx/LogOff";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        //we logged off, so go back to logon page,
                        showPanel('logonPanel');
                        HideMenu();
                        clearData();
                        $("#improvementBanner").hide(); // Hide banner on logout
                    }
                    else {
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        // Ensure the DOM is fully loaded before attaching event listeners
        $(document).ready(function () {
            // Event listener for "Load Random Comment" button
            $(".randomCommentButton").click(function () {
                loadRandomComment();
            });

            // Event listener for Skip button
            $("#skipButton").click(function () {
                handleSkip();
            });
        });



        // Store the current comment to display the same one if the user cancels the skip
        var currentComment = "";
        var savedComment = ""; // Variable to save the comment for later use

        // track skipped comments to avoid showing repeats
        var skipTrackerArray = [];

        // track number of active comments in loadRandomComment() and helps with avoiding repeats
        var activeCommentCount;

        // grabs number of active comments from database and stores in var
        function getCommentCount() {

            var webMethod = "ProjectServices.asmx/CountComments";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    activeCommentCount = msg.d;
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        // Function to load a random comment from the server
        function loadRandomComment() {
            getCommentCount();
            var webMethod = "ProjectServices.asmx/GetRandomComment";

            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                data: JSON.stringify({}), // No additional parameters needed
                success: function (response) {

                    document.getElementById("replyText").value = "";
                    $("input[name='important']").prop('checked', false); // Clear radio button selection

                    console.log("Active comments: " + activeCommentCount); // for testing
                    console.log(skipTrackerArray); // for testing
                    console.log("Skips remaining: " + skipsRemaining); // for testing
                    if (response.d && typeof response.d === "string" && response.d.trim() !== "") {
                        if (skipTrackerArray.length < activeCommentCount) {
                            if (!skipTrackerArray.includes(response.d)) {
                                skipTrackerArray.push(response.d);
                                currentComment = response.d; // Store the new comment
                                $("#randomCommentDisplay").text(currentComment); // Display comment
                                savedComment = currentComment; // Save the comment for later use
                                console.log("Saved Comment: " + savedComment); // Log the saved comment for debugging
                                // Show the response panel and ensure other panels are hidden
                                showPanel("responsePanel");
                            } else {
                                // Load another comment if it's a repeat
                                loadRandomComment();
                            }
                        } else {
                            $("#randomCommentDisplay").text("No comments found."); // Handle empty response
                        }
                    } else {
                        $("#randomCommentDisplay").text("No comments found.");
                    }
                },
                error: function (xhr, status, error) {
                    console.error("AJAX Error:", xhr.responseText);
                    alert("Error loading comment.");
                }
            });
        }

        // Attach event listener to submit button
        $(document).ready(function () {
            $("#submitReplyButton").click(submitReply);
        });

        // Attach event listener to submit button for importance
        $(document).ready(function () {
            $("#submitReplyButton").click(submitImportance);
        });

        // Function to handle the skip action
        function handleSkip() {
            if (skipsRemaining > 0) {
                let userConfirmed = confirm("Are you sure you want to skip this comment?");

                if (userConfirmed) {
                    skipsRemaining--;
                    if (skipsRemaining == 0) {
                        $(".randomCommentButton").css("visibility", "hidden");
                    }
                    loadRandomComment(); // Load a new comment only if the user confirms
                } else {
                    // If user cancels, show the same comment again
                    $("#randomCommentDisplay").text(savedComment);
                }
            } else {
                alert("You have no more skips!");
                // Ensure the displayed comment remains the same
                $("#randomCommentDisplay").text(savedComment);
            }
        }

        // Function to handle the cancel action
        $("#cancelButton").on("click", function () {
            $("#randomCommentDisplay").text(savedComment); // Display the saved comment
        });

        // array to hold comments and their respective replies and user info for each
        var commentsArray;

        function showActiveComments() {
            var webMethod = "ProjectServices.asmx/GetActiveComments";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        commentsArray = msg.d;
                        $("#commentPanel").empty();

                        // Count replies with the same commentID (i.e. all replies to a single comment)
                        for (var i = 0; i < commentsArray.length; i++) {
                            var count = 0;
                            for (var j = i + 1; j < commentsArray.length; j++) {
                                if (commentsArray[i].commentID == commentsArray[j].commentID) {
                                    count++;
                                }
                            }

                            var priority;
                            if (commentsArray[i].priority == 0) {
                                priority = "LOW"
                            }
                            else {
                                priority = "HIGH"
                            }

                            var totalImportance = commentsArray[i].totalImportance;



                            // Create the base comment HTML structure
                            var comment =
                                "<div id='comment" + i + "'>" +
                                "<p>PRIORITY: " + priority + "</p>" +
                                "<p>IMPORTANCE VOTES TOTAL: " + totalImportance + "</p>" +
                                "<p>" + commentsArray[i].comment_firstname + " " +
                                commentsArray[i].comment_lastname + ": " +
                                commentsArray[i].comment_content + "</p>" +
                                "<p>" + commentsArray[i].reply_firstname + " " +
                                commentsArray[i].reply_lastname + ": " +
                                commentsArray[i].reply_content + "</p>" +

                                "</div><hr>";
                            // Append the comment to the #commentPanel
                            // !! VERY IMPORTANT !! Must append <div> to DOM before you can append to it
                            $("#commentPanel").append(comment);

                            // Append remaining replies associated with this comment
                            for (var c = i + 1; c <= count + i; c++) {
                                // Append each reply to the associated comment div
                                $("#comment" + i).append(
                                    "<p>" + commentsArray[c].reply_firstname + " " +
                                    commentsArray[c].reply_lastname + ": " +
                                    commentsArray[c].reply_content + "</p>");
                            }
                            $("#comment" + i).append(
                                "<button onclick=archiveComment(" + commentsArray[i].commentID + ")>Archive</button>" +
                                "<button onclick=deleteComment(" + commentsArray[i].commentID + ")>Delete</button>"
                            );
                            if (commentsArray[i].priority == 1) {
                                $("#comment" + i).append(
                                    "<button onclick=setLowPriorityComment(" + commentsArray[i].commentID + ")>Set LOW Priority</button>"
                                );
                            }
                            if (commentsArray[i].priority == 0) {
                                $("#comment" + i).append(
                                    "<button onclick=setHighPriorityComment(" + commentsArray[i].commentID + ")>Set HIGH Priority</button>"
                                );
                            }
                            // Skip number of replies to avoid repeating them (i.e. we already added them above)
                            i = i + count;
                        }
                        showPanel('commentPanel');
                    }
                    else {
                        alert("No comments to show or you do not have access rights.")
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        function showArchivedComments() {
            var webMethod = "ProjectServices.asmx/GetArchivedComments";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        commentsArray = msg.d;
                        $("#archivedPanel").empty();

                        // Count replies with the same commentID (i.e. all replies to a single comment)
                        for (var i = 0; i < commentsArray.length; i++) {
                            var count = 0;
                            for (var j = i + 1; j < commentsArray.length; j++) {
                                if (commentsArray[i].commentID == commentsArray[j].commentID) {
                                    count++;
                                }
                            }
                            var priority;
                            if (commentsArray[i].priority == 0) {
                                priority = "LOW"
                            }
                            else {
                                priority = "HIGH"
                            }
                            var totalImportance = commentsArray[i].totalImportance;

                            // Create the comment HTML structure
                            var comment =
                                "<div id='archcomment" + i + "'>" +
                                "<p>PRIORITY: " + priority + "</p>" +
                                "<p>IMPORTANCE VOTES TOTAL: " + totalImportance + "</p>" +
                                "<p>" + commentsArray[i].comment_firstname + " " +
                                commentsArray[i].comment_lastname + ": " +
                                commentsArray[i].comment_content + "</p>" +
                                "<p>" + commentsArray[i].reply_firstname + " " +
                                commentsArray[i].reply_lastname + ": " +
                                commentsArray[i].reply_content + "</p>" +

                                "</div><hr>";
                            // Append the comment to the #archivedPanel
                            // !! VERY IMPORTANT !! Must append <div> to DOM before you can append to it
                            $("#archivedPanel").append(comment);

                            // Append remaining replies associated with this comment
                            for (var c = i + 1; c <= count + i; c++) {
                                // Append each reply to the associated comment div
                                $("#archcomment" + i).append(
                                    "<p>" + commentsArray[c].reply_firstname + " " +
                                    commentsArray[c].reply_lastname + ": " +
                                    commentsArray[c].reply_content + "</p>");
                            }
                            $("#archcomment" + i).append(
                                "<button onclick=unArchiveComment(" + commentsArray[i].commentID + ")>Unarchive</button>" +
                                "<button onclick=deleteComment(" + commentsArray[i].commentID + ")>Delete</button>"
                            );
                            if (commentsArray[i].priority == 1) {
                                $("#archcomment" + i).append(
                                    "<button onclick=setLowPriorityComment(" + commentsArray[i].commentID + ")>Set LOW Priority</button>"
                                );
                            }
                            if (commentsArray[i].priority == 0) {
                                $("#archcomment" + i).append(
                                    "<button onclick=setHighPriorityComment(" + commentsArray[i].commentID + ")>Set HIGH Priority</button>"
                                );
                            }
                            // Skip number of replies to avoid repeating them (i.e. we already added them above)
                            i = i + count;
                        }
                        showPanel('archivedPanel');
                    }
                    else {
                        alert("No comments to show or you do not have access rights.")
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        function archiveComment(commentID) {
            var answer = window.confirm("Archive comment?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/ArchiveComment";
                var parameters = "{\"id\":\"" + encodeURI(commentID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        //we moved a comment so refresh page we were viewing
                        var vis = window.getComputedStyle(document.getElementById('archivedPanel')).visibility === 'visible';
                        if (vis) {
                            showArchivedComments();
                        }
                        else {
                            showActiveComments();
                        }
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        function unArchiveComment(commentID) {
            var answer = window.confirm("Unarchive comment?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/UnArchiveComment";
                var parameters = "{\"id\":\"" + encodeURI(commentID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        //we moved a comment so refresh page we were viewing
                        var vis = window.getComputedStyle(document.getElementById('archivedPanel')).visibility === 'visible';
                        if (vis) {
                            showArchivedComments();
                        }
                        else {
                            showActiveComments();
                        }
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        function deleteComment(commentID) {
            var answer = window.confirm("Permanently delete comment?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/DeleteComment";
                var parameters = "{\"id\":\"" + encodeURI(commentID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        //we deleted comment so refresh comments page we were viewing
                        var vis = window.getComputedStyle(document.getElementById('archivedPanel')).visibility === 'visible';
                        if (vis) {
                            showArchivedComments();
                        }
                        else {
                            showActiveComments();
                        }
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        // Submit improvement and refresh the banner
        function submitImprovement() {
            var improvement = $("#improvementText").val().trim();
            if (improvement === "") {
                alert("Please enter an improvement message.");
                return;
            }

            $.ajax({
                type: "POST",
                url: "ProjectServices.asmx/AddImprovement",
                data: JSON.stringify({ content: improvement }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert("Improvement submitted successfully!");
                    $("#improvementText").val(""); // Clear input
                    fetchImprovementBanner();       // Refresh banner after submission
                },
                error: function () {
                    alert("Error submitting improvement.");
                }
            });
        }

        // Fetch and display the improvement banner only for users after login
        function fetchImprovementBanner() {
            $.ajax({
                type: "POST",
                url: "ProjectServices.asmx/GetActiveImprovements", // Correct method name
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    var improvementData = JSON.parse(response.d);

                    if (improvementData.success && improvementData.improvements.length > 0) {
                        var improvementsText = improvementData.improvements.join(" | "); // Join multiple improvements
                        $("#improvementMessage").text(improvementsText);
                        $("#improvementBanner").show(); // Show banner
                    } else {
                        $("#improvementBanner").hide(); // Hide if no improvements
                    }
                },
                error: function () {
                    $("#improvementBanner").hide(); // Hide on error
                }
            });
        }


        // Admin toggles improvement display status
        function toggleImprovement(display) {
            $.ajax({
                type: "POST",
                url: "ProjectServices.asmx/ToggleImprovementDisplay",
                data: JSON.stringify({ improvementID: 1, isDisplayed: display }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert(display ? "Improvement is now visible to users!" : "Improvement is now hidden from users.");
                    fetchImprovementBanner(); // Update banner immediately
                },
                error: function () {
                    alert("Error updating display status.");
                }
            });
        }


        // array to hold user account info
        var accountsArray;

        function showUsers() {
            var webMethod = "ProjectServices.asmx/GetUsers";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        accountsArray = msg.d;
                        $("#accountPanel").empty();

                        for (var i = 0; i < accountsArray.length; i++) {

                            // Create the account HTML structure
                            var account =
                                "<div id='account" + i + "'>" +
                                "<p>" + accountsArray[i].firstname + " " +
                                accountsArray[i].lastname + "</p>" +
                                "</div><hr>";
                            // Append the account to the #accountPanel
                            $("#accountPanel").append(account);
                            // Append ADMIN and ACTIVE status
                            var isAdmin = accountsArray[i].admin == 1 ? "Admin" : "Not Admin";
                            var isActive = accountsArray[i].active == 1 ? "Active" : "Inactive";
                            $("#account" + i).append(
                                "<p> Admin Status: " + isAdmin + "</p>" +
                                "<p> Active Status: " + isActive + "</p>"
                            );
                            // append buttons depending on admin and active status; toggles each and reorders list
                            // Order: Admins > Active > Inactive
                            if (accountsArray[i].admin == 1) {
                                $("#account" + i).append(
                                    "<button onclick=demoteAdmin(" + accountsArray[i].accountID + ")>Demote Admin</button>"
                                );
                            }
                            if (accountsArray[i].admin == 0) {
                                $("#account" + i).append(
                                    "<button onclick=promoteAdmin(" + accountsArray[i].accountID + ")>Promote Admin</button>"
                                );
                            }
                            if (accountsArray[i].active == 1) {
                                $("#account" + i).append(
                                    "<button onclick=deactivateAccount(" + accountsArray[i].accountID + ")>Deactivate Account</button>"
                                );
                            }
                            if (accountsArray[i].active == 0) {
                                $("#account" + i).append(
                                    "<button onclick=activateAccount(" + accountsArray[i].accountID + ")>Activate Account</button>"
                                );
                            }
                        }
                        showPanel('accountPanel');
                    }
                    else {
                        alert("No users to show or you do not have access rights.")
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        function deactivateAccount(accountID) {
            var answer = window.confirm("Deactivate account?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/DeactivateAccount";
                var parameters = "{\"id\":\"" + encodeURI(accountID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        // refresh user list
                        showUsers();
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        function activateAccount(accountID) {
            var answer = window.confirm("Activate account?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/ActivateAccount";
                var parameters = "{\"id\":\"" + encodeURI(accountID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        // refresh user list
                        showUsers();
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        function demoteAdmin(accountID) {
            var answer = window.confirm("Remove admin access from this user?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/DemoteAdmin";
                var parameters = "{\"id\":\"" + encodeURI(accountID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        // refresh user list
                        showUsers();
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        function promoteAdmin(accountID) {
            var answer = window.confirm("Grant admin access to this user?");
            if (answer) {
                var webMethod = "ProjectServices.asmx/PromoteAdmin";
                var parameters = "{\"id\":\"" + encodeURI(accountID) + "\"}";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    data: parameters,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        // refresh user list
                        showUsers();
                    },
                    error: function (e) {
                        alert("Error in delivering the message to the server or the server processing that message");
                    }
                });
            }
        }

        function setHighPriorityComment(commentID) {

            var webMethod = "ProjectServices.asmx/SetHighPriorityComment";
            var parameters = "{\"id\":\"" + encodeURI(commentID) + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var vis = window.getComputedStyle(document.getElementById('archivedPanel')).visibility === 'visible';
                    if (vis) {
                        showArchivedComments();
                    }
                    else {
                        showActiveComments();
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });

        }

        function setLowPriorityComment(commentID) {

            var webMethod = "ProjectServices.asmx/SetLowPriorityComment";
            var parameters = "{\"id\":\"" + encodeURI(commentID) + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var vis = window.getComputedStyle(document.getElementById('archivedPanel')).visibility === 'visible';
                    if (vis) {
                        showArchivedComments();
                    }
                    else {
                        showActiveComments();
                    }
                },
                error: function (e) {
                    alert("Error in delivering the message to the server or the server processing that message");
                }
            });
        }

        // Function to navigate back to the home (main) panel
        function goHome() {
            document.getElementById("suggestionText").value = "";
            document.getElementById("improvementText").value = "";
            showPanel('mainPanel');
        }


        //this function executes once jQuery has successfully loaded and is
        //ready for business.  Usually, if we're wiring up event handlers via jQuery
        //then this is where they go.
        jQuery(function () {
            showPanel('logonPanel');
        });


    </script>
    <!--END OF YOUR OWN JAVASCRIPT-->
    <!--AND YOUR OWN CSS CAN GO HERE AS WELL-->
    <style>

        /* GENERAL STYLES */
        :root {
            --primary-color: #3ab0ff; /*light blue*/
            --secondary-color: black;
            --accent-color: #00c49a; /*light green*/
            --background-color: #f5f5f5; /*white*/
            --another-color: #ffb74d; /*orange*/
            --text-color: black;
            --border-radius: 8px;
            --transition-speed: 0.3s;
        }

        html {
            background: linear-gradient(to right, #00c49a, #3ab0ff);
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow-x:hidden;
            
        }

        * {
            margin: 0;
            padding: 0;
        }

        /* LAYOUT AND CONTAINER */
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            background: #f5f5f5;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: var(--border-radius);
        }

        .emptySpace {
            height: 5vh;
        }
        /*TYPOGRAPHY*/
        .title {
            font-family: "Montserrat", serif;
            font-size: xx-large;
            font-weight: 700;
            font-style: normal;
            color: #f5f5f5;
        }

        .header {
            font-family: "Montserrat", serif;
            font-size: x-large;
            font-weight: 700;
            font-style: normal;
            color: black;
            width: 100%;
            padding: 10px;
        }


        .body {
            font-family: "Open Sans", serif;
            font-size: large;
            font-weight: 500;
            font-style: normal;
        }

        .textarea {
            background-color: #f5f5f5;
        }

    


        /*BUTTONS AND RADIO BUTTONS*/
        .button {
            font-family: "Open Sans", serif;
            font-size: medium;
            font-weight: 500;
            font-style: normal;
            color: var(--background-color);
            background-color: black;
            width: 200px;
            height: 80px;
            border-radius: var(--border-radius);
            padding: 10px;
            cursor: pointer;
            transition: background var(--transition-speed);
            margin: 6px;
        }

            .button:hover {
                background-color: darkgray;
            }

        .adminButtons, .navButtons {
            display: flex;
            gap: 12px; /* space between buttons */
        }

        .radio{
            width:20px;
        }



        /*FORMS & INPUTS*/
        #logonId, #logonPassword {
            margin-top: 15px;
            width: 100%;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input, select, textarea {
            width: 30%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: var(--border-radius);
            font-size: 16px;
        }

            input:focus, select:focus, textarea:focus {
                border-color: var(--primary-color);
                outline: none;
                box-shadow: 0 0 5px rgba(58, 176, 255, 0.5);
            }

        /*PANELS AND VISIBILITY*/

      

        .menu, .contentPanel {
            visibility: hidden;
            width: 100%;
        }

        .menu {
            width: 100vw;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            font-family: "Open Sans", serif;
            font-optical-sizing: auto;
            font-weight: 100;
            font-style: normal;
            margin-top: 8vh;
            width: 100vw;
            background-color: #3ab0ff;
        }

        .main {
            margin-top: 10vh;
        }

        .blueBackground {
            background-color: #3ab0ff;
        }

        .contentPanel {
            position: absolute;
            background: linear-gradient(to right, #00c49a, #3ab0ff);
            height: 100%;
            width: 100%;
        }


        .commentPanel, .archivedPanel {
            height: 100%;
        }

        .logonBox {
            display: flex;
            justify-content: center; /* Centers horizontally */
            width: 50vw;
            height: 40vh;
            color: black;
            background-color: #f5f5f5;
            box-shadow: 0 0 5px rgba(58, 176, 255, 0.5);
            border-radius: var(--border-radius);
        }

        #logonForm {
            width: 100%;
            height: 100%;
        }

        #logonPanel {
            display: flex;
            justify-content: center; /* Centers horizontally */
        }


        .titleContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 10vh;
            background-color: black;
            z-index: 1000;
        }


        #randomCommentDisplay {
            background-color: black;
            color: #f5f5f5;
            font-family: "Open Sans", serif;
            font-size: xx-large;
            font-weight: 800;
            font-style: normal;
            width: 80vw;
            height: 8vh;
            margin-top: 10px;
            text-align: center;
        }

        #suggestionText {
            width: 90%;
            height: 20vh;
            background-color: #f5f5f5;
        }

        #improvementBanner {
            display: none;
            background: #ffb74d;
            padding: 15px;
            font-family: "Open Sans", serif;
            font-size: xx-large;
            font-weight: 600;
            font-style: italic;
            height: 12vh;
        }

        #improvementText {
            width: 100vw;
        }



        .adminBanner {
            margin-top: 20px;
            padding: 15px;
            border: 2px solid #002d62;
            background-color: #ffb74d;
            border-radius: 10px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            width:90vw;
        }

        .mainPanel, #responsePanel {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 5px;
            height: 30vh;
        }

        #replyText {
            width: 100vw;
        }

        #rateComment {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .radio-group {
            display: flex;
            align-items: flex-start;
            margin-top: 5px;
            width: 50%;
        }

        .radio-group input[type="radio"] {
            margin-right: 5px;
            }

        /* ALIGNMENT & SPACING */
        .centered {
            text-align: center;
        }

        .flex {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* MOBILE RESPONSIVENESS */
        @media (max-width: 800px) {
            #menu {
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .navButtons {
                order: -1; /* Moves navButtons to the top */
            }

            .adminButtons {
                order: 1; /* Keeps adminButtons below */
            }
        }
    </style>

    <!--END OF YOUR OWN CSS-->
</head>
<body>

    <div class="titleContainer">
        <img src="images/Logo-Text.jpg" alt="Logo Text">

    </div>

    <div id="menu" class="menu">
        <div class="adminButtons">
            <button class="button adminOnly" onclick=showActiveComments()>Active Comments</button>
            <button class="button adminOnly" onclick=showArchivedComments()>Archived Comments</button>
            <button class="button adminOnly" onclick=showUsers()>User List</button>
        </div>

        <div class="navButtons">
            <button class="button navButton" onclick=LogOff()>Log Off</button>
            <button class="button navButton" onclick=goHome()>Home</button>
        </div>
    </div>

        <!-- Improvement Banner (Visible to All Users) -->
        <div id="improvementBanner" class="centered">
            <p id="improvementMessage"></p>
        </div>

        <!--
        we're using a stacked card approach for our main viewing area
        add cards within contentContainer array (above in JavaScript section) as individual divs
        !! DON'T FORGET TO ADD DIV ID TO JAVASCRIPT ARRAY: contentPanels !!
        that method allows us to easly switch the interface from one to the other
        -->
        <div class="contentContainer">

            <div id="logonPanel" class="contentPanel logonPanel">
                <div class="logonBox body">
                    <form id="logonForm" onsubmit="LogOn($('#logonId').val(), $('#logonPassword').val()); return false;">
                        <div class="left header blueBackground">Sign In.</div>
                        <div>
                            <input type="text" id="logonId" class="body textarea" placeholder="Username" />
                        </div>
                        <div>
                            <input type="password" id="logonPassword" class="body textarea" placeholder="Password" />
                        </div>

                        <div>
                            <button class="button" type="submit">Go!</button>
                        </div>
                    </form>
                </div>
            </div>


            <div id="mainPanel" class="contentPanel mainPanel">
                <div id="improvedTitle" class="header">What would you like to see improved?</div>
                <!-- Suggestion Input Box -->
                <textarea id="suggestionText" class="body textarea" placeholder="Enter your suggestion here..."></textarea>

                <!-- Submit Button -->
                <button class="button" onclick="submitSuggestion()">Submit Suggestion</button>

                <!-- Button that the user clicks to load a random comment -->
                <button class="randomCommentButton button">Load Random Comment</button>
                <!--</div>-->

              

                <!-- Admin Improvement Panel (Visible to Admins Only) -->
                <div id="adminPanel" class="adminOnly adminBanner">
                    <div class="left header">What improvements have already been made?</div>
                    <textarea id="improvementText" class="body" placeholder="Enter improvement message..." ></textarea>
                        <button class="button" onclick="submitImprovement()">Submit Improvement</button>
                        <button class="button" onclick="toggleImprovement(true)">Display Improvement</button>
                        <button class="button" onclick="toggleImprovement(false)">Hide Improvement</button>
                    </div>
                </div>
            </div>


        <div id="responsePanel" class="responsePanel contentPanel body">
            <!-- The div where the random comment will be displayed -->
            <div id="randomCommentDisplay"></div>

            

            <div id="rateComment">
                <!-- The div where the user selects if a comment is important or not-->
                <label>Do you think this topic is important?</label>
                <div class="radio-group">
                    <input type="radio" id="yes" name="important" value="1">
                    <label for="yes">Yes, it is something that needs to be addressed.</label>
                    <input type="radio" id="no" name="important" value="0">
                    <label for="no">No, I don't believe this issue needs to be addressed.</label>
                </div>
            </div>

           

           
            <!-- Reply Input Box -->
            <textarea id="replyText" placeholder="Enter your reasoning here." class="body textarea"></textarea>

            <!-- Submit Button -->
            <button id="submitReplyButton" class="button">Submit Reply</button>

            <!-- Skip Button -->
            <button id="skipButton" class="button">Skip Comment</button>

        </div>

            <!-- Panel to display active comments and replies -->
            <div id="commentPanel" class="contentPanel commentPanel body"></div>

            <!-- Panel to display archived comments and replies -->
            <div id="archivedPanel" class="contentPanel archivedPanel body"></div>

            <!-- Panel to display user account info -->
            <div id="accountPanel" class="contentPanel accountPanel body"></div>

        

</body>
</html>